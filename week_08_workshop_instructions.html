<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Loza Biru">

<title>Workshop Exercise: Grouping, Summarizing and Plotting</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="week_08_workshop_instructions_files/libs/clipboard/clipboard.min.js"></script>
<script src="week_08_workshop_instructions_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="week_08_workshop_instructions_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="week_08_workshop_instructions_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="week_08_workshop_instructions_files/libs/quarto-html/popper.min.js"></script>
<script src="week_08_workshop_instructions_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="week_08_workshop_instructions_files/libs/quarto-html/anchor.min.js"></script>
<link href="week_08_workshop_instructions_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="week_08_workshop_instructions_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="week_08_workshop_instructions_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="week_08_workshop_instructions_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="week_08_workshop_instructions_files/libs/bootstrap/bootstrap-d6a003b94517c951b2d65075d42fb01b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
</script>
<script type="module">import "https://cdn.plot.ly/plotly-3.1.1.min"</script>



</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Workshop Exercise: Grouping, Summarizing and Plotting</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Loza Biru </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="data-preparation" class="level1">
<h1>1. Data Preparation</h1>
<section id="load-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-packages">1.1. Load Packages</h2>
<p>To get started, <strong>load in the needed packages</strong>: pandas, numpy, plotly express.</p>
<div id="d98e68dc" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="import-data" class="level2">
<h2 class="anchored" data-anchor-id="import-data">1.2. Import Data</h2>
<p>Download the <code>india_tuberculosis.csv</code> file from the course portal and save it in your <code>data</code> folder.</p>
<p>Now, <strong>read in the <code>india_tuberculosis</code> dataset into Python from your data folder</strong> into a DataFrame called <code>tb</code>. The DataFrame you import should have 880 rows and 21 columns. Remember to use relative paths to allow your script to use project-relative paths.</p>
<div id="c9662d35" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>tb <span class="op">=</span> pd.read_csv(<span class="st">"data/india_tuberculosis.csv"</span>) </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>tb</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Education</th>
<th data-quarto-table-cell-role="th">Employment</th>
<th data-quarto-table-cell-role="th">Alcohol</th>
<th data-quarto-table-cell-role="th">Smoking</th>
<th data-quarto-table-cell-role="th">WtinKgs</th>
<th data-quarto-table-cell-role="th">HtinCms</th>
<th data-quarto-table-cell-role="th">bmi</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Form of TB</th>
<th data-quarto-table-cell-role="th">Chext Xray</th>
<th data-quarto-table-cell-role="th">first visit location</th>
<th data-quarto-table-cell-role="th">first visit cost</th>
<th data-quarto-table-cell-role="th">second visit location</th>
<th data-quarto-table-cell-role="th">second visit cost</th>
<th data-quarto-table-cell-role="th">third visit location</th>
<th data-quarto-table-cell-role="th">third visit cost</th>
<th data-quarto-table-cell-role="th">Health sys delay (in days)</th>
<th data-quarto-table-cell-role="th">Treatment initiation delay (in days)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>100202</td>
<td>Male</td>
<td>57</td>
<td>Middle</td>
<td>Working</td>
<td>Yes</td>
<td>Yes</td>
<td>58.0</td>
<td>165.0</td>
<td>21.3</td>
<td>...</td>
<td>Ini smear +</td>
<td>NaN</td>
<td>GH</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>15.0</td>
<td>10.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>100396</td>
<td>Female</td>
<td>66</td>
<td>No Education</td>
<td>Non - Working</td>
<td>No</td>
<td>No</td>
<td>32.0</td>
<td>163.0</td>
<td>12.0</td>
<td>...</td>
<td>Ini smear -</td>
<td>Positive</td>
<td>Pvt. docto</td>
<td>1500</td>
<td>Pvt. clini</td>
<td>1000</td>
<td>Pvt. hospi</td>
<td>2500</td>
<td>60.0</td>
<td>4.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>100590</td>
<td>Female</td>
<td>45</td>
<td>Missing</td>
<td>Non - Working</td>
<td>No</td>
<td>No</td>
<td>46.0</td>
<td>150.0</td>
<td>20.4</td>
<td>...</td>
<td>Ini smear -</td>
<td>Positive</td>
<td>Pvt. docto</td>
<td>2000</td>
<td>Pvt. docto</td>
<td>3000</td>
<td>PHC</td>
<td>0</td>
<td>43.0</td>
<td>21.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>100687</td>
<td>Male</td>
<td>27</td>
<td>Middle</td>
<td>Non - Working</td>
<td>No</td>
<td>No</td>
<td>51.0</td>
<td>165.0</td>
<td>18.7</td>
<td>...</td>
<td>Ini smear +</td>
<td>NaN</td>
<td>Pvt. hospi</td>
<td>20000</td>
<td>Pvt. hospi</td>
<td>1500</td>
<td>PHC</td>
<td>0</td>
<td>35.0</td>
<td>5.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>100784</td>
<td>Male</td>
<td>54</td>
<td>Middle</td>
<td>Non - Working</td>
<td>No</td>
<td>No</td>
<td>39.0</td>
<td>160.0</td>
<td>15.2</td>
<td>...</td>
<td>Ini smear +</td>
<td>Positive</td>
<td>Pvt. docto</td>
<td>1000</td>
<td>GH</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>14.0</td>
<td>6.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">875</th>
<td>1604672</td>
<td>Male</td>
<td>44</td>
<td>Middle</td>
<td>Working</td>
<td>Yes</td>
<td>Yes</td>
<td>42.7</td>
<td>175.0</td>
<td>13.9</td>
<td>...</td>
<td>Ini smear +</td>
<td>NaN</td>
<td>Pvt. docto</td>
<td>9000</td>
<td>Pvt. docto</td>
<td>800</td>
<td>GH</td>
<td>0</td>
<td>14.0</td>
<td>11.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">876</th>
<td>1604769</td>
<td>Male</td>
<td>60</td>
<td>Middle</td>
<td>Working</td>
<td>No</td>
<td>No</td>
<td>64.2</td>
<td>175.0</td>
<td>21.0</td>
<td>...</td>
<td>Ini smear +</td>
<td>Positive</td>
<td>Pvt. clini</td>
<td>500</td>
<td>Tambram Sanatorium</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>14.0</td>
<td>10.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">877</th>
<td>1604866</td>
<td>Male</td>
<td>63</td>
<td>Middle</td>
<td>Working</td>
<td>No</td>
<td>Yes</td>
<td>38.5</td>
<td>160.0</td>
<td>15.0</td>
<td>...</td>
<td>Ini smear +</td>
<td>NaN</td>
<td>Pvt. docto</td>
<td>1000</td>
<td>Tambram Sanatorium</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>180.0</td>
<td>22.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">878</th>
<td>1604963</td>
<td>Male</td>
<td>65</td>
<td>No Education</td>
<td>Working</td>
<td>No</td>
<td>No</td>
<td>37.0</td>
<td>167.0</td>
<td>13.3</td>
<td>...</td>
<td>Ini smear +</td>
<td>NaN</td>
<td>PHC</td>
<td>0</td>
<td>Tambram Sanatorium</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>150.0</td>
<td>20.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">879</th>
<td>1605060</td>
<td>Male</td>
<td>60</td>
<td>Middle</td>
<td>Working</td>
<td>No</td>
<td>No</td>
<td>46.8</td>
<td>155.5</td>
<td>19.4</td>
<td>...</td>
<td>Missing</td>
<td>Positive</td>
<td>Pvt. hospi</td>
<td>300</td>
<td>Pvt. clini</td>
<td>3200</td>
<td>GH</td>
<td>0</td>
<td>90.0</td>
<td>2.0</td>
</tr>
</tbody>
</table>

<p>880 rows × 21 columns</p>
</div>
</div>
</div>
<p>Run the following line of code to convert all column names to lowercase and replace spaces with underscores:</p>
<div id="9fa99581" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>tb.columns <span class="op">=</span> tb.columns.<span class="bu">str</span>.lower().<span class="bu">str</span>.replace(<span class="st">' '</span>, <span class="st">'_'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="calculate-total-cost" class="level2">
<h2 class="anchored" data-anchor-id="calculate-total-cost">1.3. Calculate Total Cost</h2>
<p>Each patient record notes the location and cost of up to three visits. Add together these costs (<code>first_visit_cost</code>, <code>second_visit_cost</code>, and <code>third_visit_cost</code>) to create a <code>total_cost</code> variable.</p>
<div id="e40cf939" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>tb[<span class="st">'total_cost'</span>] <span class="op">=</span> tb[<span class="st">'first_visit_cost'</span>] <span class="op">+</span> tb[<span class="st">'second_visit_cost'</span>] <span class="op">+</span> tb[<span class="st">'third_visit_cost'</span>]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>tb</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">employment</th>
<th data-quarto-table-cell-role="th">alcohol</th>
<th data-quarto-table-cell-role="th">smoking</th>
<th data-quarto-table-cell-role="th">wtinkgs</th>
<th data-quarto-table-cell-role="th">htincms</th>
<th data-quarto-table-cell-role="th">bmi</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">chext_xray</th>
<th data-quarto-table-cell-role="th">first_visit_location</th>
<th data-quarto-table-cell-role="th">first_visit_cost</th>
<th data-quarto-table-cell-role="th">second_visit_location</th>
<th data-quarto-table-cell-role="th">second_visit_cost</th>
<th data-quarto-table-cell-role="th">third_visit_location</th>
<th data-quarto-table-cell-role="th">third_visit_cost</th>
<th data-quarto-table-cell-role="th">health_sys_delay_(in_days)</th>
<th data-quarto-table-cell-role="th">treatment_initiation_delay_(in_days)</th>
<th data-quarto-table-cell-role="th">total_cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>100202</td>
<td>Male</td>
<td>57</td>
<td>Middle</td>
<td>Working</td>
<td>Yes</td>
<td>Yes</td>
<td>58.0</td>
<td>165.0</td>
<td>21.3</td>
<td>...</td>
<td>NaN</td>
<td>GH</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>15.0</td>
<td>10.0</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>100396</td>
<td>Female</td>
<td>66</td>
<td>No Education</td>
<td>Non - Working</td>
<td>No</td>
<td>No</td>
<td>32.0</td>
<td>163.0</td>
<td>12.0</td>
<td>...</td>
<td>Positive</td>
<td>Pvt. docto</td>
<td>1500</td>
<td>Pvt. clini</td>
<td>1000</td>
<td>Pvt. hospi</td>
<td>2500</td>
<td>60.0</td>
<td>4.0</td>
<td>5000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>100590</td>
<td>Female</td>
<td>45</td>
<td>Missing</td>
<td>Non - Working</td>
<td>No</td>
<td>No</td>
<td>46.0</td>
<td>150.0</td>
<td>20.4</td>
<td>...</td>
<td>Positive</td>
<td>Pvt. docto</td>
<td>2000</td>
<td>Pvt. docto</td>
<td>3000</td>
<td>PHC</td>
<td>0</td>
<td>43.0</td>
<td>21.0</td>
<td>5000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>100687</td>
<td>Male</td>
<td>27</td>
<td>Middle</td>
<td>Non - Working</td>
<td>No</td>
<td>No</td>
<td>51.0</td>
<td>165.0</td>
<td>18.7</td>
<td>...</td>
<td>NaN</td>
<td>Pvt. hospi</td>
<td>20000</td>
<td>Pvt. hospi</td>
<td>1500</td>
<td>PHC</td>
<td>0</td>
<td>35.0</td>
<td>5.0</td>
<td>21500</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>100784</td>
<td>Male</td>
<td>54</td>
<td>Middle</td>
<td>Non - Working</td>
<td>No</td>
<td>No</td>
<td>39.0</td>
<td>160.0</td>
<td>15.2</td>
<td>...</td>
<td>Positive</td>
<td>Pvt. docto</td>
<td>1000</td>
<td>GH</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>14.0</td>
<td>6.0</td>
<td>1000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">875</th>
<td>1604672</td>
<td>Male</td>
<td>44</td>
<td>Middle</td>
<td>Working</td>
<td>Yes</td>
<td>Yes</td>
<td>42.7</td>
<td>175.0</td>
<td>13.9</td>
<td>...</td>
<td>NaN</td>
<td>Pvt. docto</td>
<td>9000</td>
<td>Pvt. docto</td>
<td>800</td>
<td>GH</td>
<td>0</td>
<td>14.0</td>
<td>11.0</td>
<td>9800</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">876</th>
<td>1604769</td>
<td>Male</td>
<td>60</td>
<td>Middle</td>
<td>Working</td>
<td>No</td>
<td>No</td>
<td>64.2</td>
<td>175.0</td>
<td>21.0</td>
<td>...</td>
<td>Positive</td>
<td>Pvt. clini</td>
<td>500</td>
<td>Tambram Sanatorium</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>14.0</td>
<td>10.0</td>
<td>500</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">877</th>
<td>1604866</td>
<td>Male</td>
<td>63</td>
<td>Middle</td>
<td>Working</td>
<td>No</td>
<td>Yes</td>
<td>38.5</td>
<td>160.0</td>
<td>15.0</td>
<td>...</td>
<td>NaN</td>
<td>Pvt. docto</td>
<td>1000</td>
<td>Tambram Sanatorium</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>180.0</td>
<td>22.0</td>
<td>1000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">878</th>
<td>1604963</td>
<td>Male</td>
<td>65</td>
<td>No Education</td>
<td>Working</td>
<td>No</td>
<td>No</td>
<td>37.0</td>
<td>167.0</td>
<td>13.3</td>
<td>...</td>
<td>NaN</td>
<td>PHC</td>
<td>0</td>
<td>Tambram Sanatorium</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>150.0</td>
<td>20.0</td>
<td>0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">879</th>
<td>1605060</td>
<td>Male</td>
<td>60</td>
<td>Middle</td>
<td>Working</td>
<td>No</td>
<td>No</td>
<td>46.8</td>
<td>155.5</td>
<td>19.4</td>
<td>...</td>
<td>Positive</td>
<td>Pvt. hospi</td>
<td>300</td>
<td>Pvt. clini</td>
<td>3200</td>
<td>GH</td>
<td>0</td>
<td>90.0</td>
<td>2.0</td>
<td>3500</td>
</tr>
</tbody>
</table>

<p>880 rows × 22 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="investigating-healthcare-costs-by-education-level" class="level1">
<h1>2. Investigating Healthcare Costs by Education Level</h1>
<section id="reorder-education-levels" class="level2">
<h2 class="anchored" data-anchor-id="reorder-education-levels">2.1. Reorder Education Levels</h2>
<p>Before moving further, let’s take a closer look at the <code>education</code> variable in our dataset:</p>
<div id="17b418e8" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count unique values of education levels</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>tb[<span class="st">"education"</span>].value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>education
No Education        273
Primary             221
Middle              191
Secondary           122
Higher Secondary     52
Graduate             12
Missing               6
Graduate &amp; Above      3
Name: count, dtype: int64</code></pre>
</div>
</div>
<p>You’ll notice that education levels are ordered in descending order by default. However, in this case, we want to reorder the education levels so that they are arranged in a chronological order (lower education levels come first).</p>
<p>First, use the <code>replace()</code> method to convert the “Graduate &amp; Above” values to “Graduate”.</p>
<div id="726d3064" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>tb[<span class="st">"education"</span>] <span class="op">=</span> tb[<span class="st">"education"</span>].replace({<span class="st">"Graduate and Above"</span>: <span class="st">"Graduate"</span>})</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>tb</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">employment</th>
<th data-quarto-table-cell-role="th">alcohol</th>
<th data-quarto-table-cell-role="th">smoking</th>
<th data-quarto-table-cell-role="th">wtinkgs</th>
<th data-quarto-table-cell-role="th">htincms</th>
<th data-quarto-table-cell-role="th">bmi</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">chext_xray</th>
<th data-quarto-table-cell-role="th">first_visit_location</th>
<th data-quarto-table-cell-role="th">first_visit_cost</th>
<th data-quarto-table-cell-role="th">second_visit_location</th>
<th data-quarto-table-cell-role="th">second_visit_cost</th>
<th data-quarto-table-cell-role="th">third_visit_location</th>
<th data-quarto-table-cell-role="th">third_visit_cost</th>
<th data-quarto-table-cell-role="th">health_sys_delay_(in_days)</th>
<th data-quarto-table-cell-role="th">treatment_initiation_delay_(in_days)</th>
<th data-quarto-table-cell-role="th">total_cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>100202</td>
<td>Male</td>
<td>57</td>
<td>Middle</td>
<td>Working</td>
<td>Yes</td>
<td>Yes</td>
<td>58.0</td>
<td>165.0</td>
<td>21.3</td>
<td>...</td>
<td>NaN</td>
<td>GH</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>15.0</td>
<td>10.0</td>
<td>0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>100396</td>
<td>Female</td>
<td>66</td>
<td>No Education</td>
<td>Non - Working</td>
<td>No</td>
<td>No</td>
<td>32.0</td>
<td>163.0</td>
<td>12.0</td>
<td>...</td>
<td>Positive</td>
<td>Pvt. docto</td>
<td>1500</td>
<td>Pvt. clini</td>
<td>1000</td>
<td>Pvt. hospi</td>
<td>2500</td>
<td>60.0</td>
<td>4.0</td>
<td>5000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>100590</td>
<td>Female</td>
<td>45</td>
<td>Missing</td>
<td>Non - Working</td>
<td>No</td>
<td>No</td>
<td>46.0</td>
<td>150.0</td>
<td>20.4</td>
<td>...</td>
<td>Positive</td>
<td>Pvt. docto</td>
<td>2000</td>
<td>Pvt. docto</td>
<td>3000</td>
<td>PHC</td>
<td>0</td>
<td>43.0</td>
<td>21.0</td>
<td>5000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>100687</td>
<td>Male</td>
<td>27</td>
<td>Middle</td>
<td>Non - Working</td>
<td>No</td>
<td>No</td>
<td>51.0</td>
<td>165.0</td>
<td>18.7</td>
<td>...</td>
<td>NaN</td>
<td>Pvt. hospi</td>
<td>20000</td>
<td>Pvt. hospi</td>
<td>1500</td>
<td>PHC</td>
<td>0</td>
<td>35.0</td>
<td>5.0</td>
<td>21500</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>100784</td>
<td>Male</td>
<td>54</td>
<td>Middle</td>
<td>Non - Working</td>
<td>No</td>
<td>No</td>
<td>39.0</td>
<td>160.0</td>
<td>15.2</td>
<td>...</td>
<td>Positive</td>
<td>Pvt. docto</td>
<td>1000</td>
<td>GH</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>14.0</td>
<td>6.0</td>
<td>1000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">875</th>
<td>1604672</td>
<td>Male</td>
<td>44</td>
<td>Middle</td>
<td>Working</td>
<td>Yes</td>
<td>Yes</td>
<td>42.7</td>
<td>175.0</td>
<td>13.9</td>
<td>...</td>
<td>NaN</td>
<td>Pvt. docto</td>
<td>9000</td>
<td>Pvt. docto</td>
<td>800</td>
<td>GH</td>
<td>0</td>
<td>14.0</td>
<td>11.0</td>
<td>9800</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">876</th>
<td>1604769</td>
<td>Male</td>
<td>60</td>
<td>Middle</td>
<td>Working</td>
<td>No</td>
<td>No</td>
<td>64.2</td>
<td>175.0</td>
<td>21.0</td>
<td>...</td>
<td>Positive</td>
<td>Pvt. clini</td>
<td>500</td>
<td>Tambram Sanatorium</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>14.0</td>
<td>10.0</td>
<td>500</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">877</th>
<td>1604866</td>
<td>Male</td>
<td>63</td>
<td>Middle</td>
<td>Working</td>
<td>No</td>
<td>Yes</td>
<td>38.5</td>
<td>160.0</td>
<td>15.0</td>
<td>...</td>
<td>NaN</td>
<td>Pvt. docto</td>
<td>1000</td>
<td>Tambram Sanatorium</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>180.0</td>
<td>22.0</td>
<td>1000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">878</th>
<td>1604963</td>
<td>Male</td>
<td>65</td>
<td>No Education</td>
<td>Working</td>
<td>No</td>
<td>No</td>
<td>37.0</td>
<td>167.0</td>
<td>13.3</td>
<td>...</td>
<td>NaN</td>
<td>PHC</td>
<td>0</td>
<td>Tambram Sanatorium</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>150.0</td>
<td>20.0</td>
<td>0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">879</th>
<td>1605060</td>
<td>Male</td>
<td>60</td>
<td>Middle</td>
<td>Working</td>
<td>No</td>
<td>No</td>
<td>46.8</td>
<td>155.5</td>
<td>19.4</td>
<td>...</td>
<td>Positive</td>
<td>Pvt. hospi</td>
<td>300</td>
<td>Pvt. clini</td>
<td>3200</td>
<td>GH</td>
<td>0</td>
<td>90.0</td>
<td>2.0</td>
<td>3500</td>
</tr>
</tbody>
</table>

<p>880 rows × 22 columns</p>
</div>
</div>
</div>
<p>Now, run the code below to reorder the education levels by converting the <code>education</code> variable into a categorical variable with the levels defined in a specific order:</p>
<div id="18bb554a" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>education_levels <span class="op">=</span> [</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No Education"</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Primary"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Middle"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Secondary"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Higher Secondary"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Graduate"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Missing"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>tb[<span class="st">"education"</span>] <span class="op">=</span> pd.Categorical(</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    tb[<span class="st">"education"</span>], categories<span class="op">=</span>education_levels, ordered<span class="op">=</span><span class="va">True</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now, inspect the <code>education</code> variable again to make sure it has been reordered correctly:</p>
<div id="d615ef9d" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tb[<span class="st">"education"</span>].value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>education
No Education        273
Primary             221
Middle              191
Secondary           122
Higher Secondary     52
Graduate             12
Missing               6
Name: count, dtype: int64</code></pre>
</div>
</div>
<p>We will use the newly transformed <code>education</code> variable for grouping, summarizing, and plotting below.</p>
</section>
<section id="table-of-costs-by-education-level" class="level2">
<h2 class="anchored" data-anchor-id="table-of-costs-by-education-level">2.2. Table of Costs by Education Level</h2>
<p>Let’s compare the cost of treatment at different health facilities using a summary table. Use pandas methods to group by education level and create a summary table with two variables:</p>
<ul>
<li>The number of patients in each education level</li>
<li>The mean total cost for each education level</li>
</ul>
<p>Store the resulting DataFrame as an object called <code>edu_cost_table</code>.</p>
<div id="231dc2f5" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary table</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>edu_cost_table <span class="op">=</span> tb.groupby(<span class="st">"education"</span>).agg(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    number_of_patients<span class="op">=</span>(<span class="st">"education"</span>, <span class="st">"size"</span>), mean_total_cost<span class="op">=</span>(<span class="st">"total_cost"</span>, <span class="st">"mean"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>).reset_index()</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>edu_cost_table </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/v_/4ghtxxl917jb734xhc9skflr0000gn/T/ipykernel_16324/1929367421.py:2: FutureWarning:

The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">number_of_patients</th>
<th data-quarto-table-cell-role="th">mean_total_cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>No Education</td>
<td>273</td>
<td>1527.435897</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Primary</td>
<td>221</td>
<td>1543.574661</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Middle</td>
<td>191</td>
<td>1988.638743</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Secondary</td>
<td>122</td>
<td>2135.000000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Higher Secondary</td>
<td>52</td>
<td>1869.230769</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>Graduate</td>
<td>12</td>
<td>3466.666667</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>Missing</td>
<td>6</td>
<td>1766.666667</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Reorder the rows of the summary table to go from highest to lowest mean cost. You can use the <code>sort_values()</code> method to do this.</p>
<div id="867f51dc" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder summary table</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>edu_cost_table <span class="op">=</span> edu_cost_table.sort_values(<span class="st">"mean_total_cost"</span>, ascending<span class="op">=</span><span class="va">False</span>) </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>edu_cost_table</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">number_of_patients</th>
<th data-quarto-table-cell-role="th">mean_total_cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">5</th>
<td>Graduate</td>
<td>12</td>
<td>3466.666667</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Secondary</td>
<td>122</td>
<td>2135.000000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Middle</td>
<td>191</td>
<td>1988.638743</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">4</th>
<td>Higher Secondary</td>
<td>52</td>
<td>1869.230769</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>Missing</td>
<td>6</td>
<td>1766.666667</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Primary</td>
<td>221</td>
<td>1543.574661</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>No Education</td>
<td>273</td>
<td>1527.435897</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Which education level has the highest mean total cost of treatment?</p>
<p>The Graduate level has the highest mean total cost of treatment.</p>
<p>Below, we will visualize the data with a plot to see if there is a relationship between education level and healthcare costs.</p>
</section>
<section id="visualize-costs-by-education-level" class="level2">
<h2 class="anchored" data-anchor-id="visualize-costs-by-education-level">2.3. Visualize Costs by Education Level</h2>
<p>Using <code>plotly.express</code> and the costs summary table you created earlier, create a bar plot of mean costs by education level. It should be sorted from lowest education level to highest education level.</p>
<div id="bdb382ab" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>custom_order <span class="op">=</span> [<span class="st">"No Education"</span>, <span class="st">"Primary"</span>, <span class="st">"Middle"</span>, <span class="st">"Secondary"</span>, <span class="st">"Higher Secondary"</span>, <span class="st">"Graduate"</span>,<span class="st">"Missing"</span>,]</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>px.bar(edu_cost_table, x<span class="op">=</span><span class="st">"education"</span>, y<span class="op">=</span><span class="st">"mean_total_cost"</span>, category_orders<span class="op">=</span>{<span class="st">"education"</span>: custom_order})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.1.1.min.js" integrity="sha256-HUEFyfiTnZJxCxur99FjbKYTvKSzwDaD3/x5TqHpFu4=" crossorigin="anonymous"></script>                <div id="3a634076-c903-4e91-bda5-a6d229d1a6bc" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("3a634076-c903-4e91-bda5-a6d229d1a6bc")) {                    Plotly.newPlot(                        "3a634076-c903-4e91-bda5-a6d229d1a6bc",                        [{"hovertemplate":"education=%{x}\u003cbr\u003emean_total_cost=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"","orientation":"v","showlegend":false,"textposition":"auto","x":["Graduate","Secondary","Middle","Higher Secondary","Missing","Primary","No Education"],"xaxis":"x","y":{"dtype":"f8","bdata":"VVVVVVUVq0AAAAAAAK6gQJWvwxKOEp9AT+zETuw0nUCrqqqqqpqbQHRM1nNMHphAXL7lW77dl0A="},"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermap":[{"type":"scattermap","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"education"},"categoryorder":"array","categoryarray":["No Education","Primary","Middle","Secondary","Higher Secondary","Graduate","Missing"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"mean_total_cost"}},"legend":{"tracegroupgap":0},"barmode":"relative"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('3a634076-c903-4e91-bda5-a6d229d1a6bc');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };            </script>        </div>
</div>
</div>
<p>Write a short interpretation of the plot.</p>
<p>There is a general trend where healthcare cost increases with education level. No education level had the lowest healthcare cost and graduate level had the highest cost. However, higher secondary level stands out as a potential anomaly as a lower healthcare cost is associated to this education level compared to both middle and secondary school education levels.</p>
</section>
</section>
<section id="investigating-healthcare-costs-by-age-group" class="level1">
<h1>3. Investigating Healthcare Costs by Age Group</h1>
<section id="create-an-age_group-variable" class="level2">
<h2 class="anchored" data-anchor-id="create-an-age_group-variable">3.1. Create an <code>age_group</code> Variable</h2>
<p>The <code>age</code> variable records the age of each patient in years. We want to classify the patients into four approximately equally-sized age groups for further analysis.</p>
<p>First, run the code below to determine the quantiles of the <code>age</code> variable to decide the cutoffs for each age group:</p>
<div id="c1b03090" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine quantiles of age</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>tb[<span class="st">"age"</span>].describe()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>count    880.000000
mean      46.668182
std       14.165329
min       18.000000
25%       37.000000
50%       48.000000
75%       58.000000
max       88.000000
Name: age, dtype: float64</code></pre>
</div>
</div>
<p>Based on the quantile markers (min, 25%, 50%, 75%, max), we can note the following four age groups with approximately equal numbers of patients:</p>
<ul>
<li>18-36</li>
<li>37-47</li>
<li>48-57</li>
<li>58+</li>
</ul>
<p>Use a custom function called <code>assign_age_group()</code>, then vectorize it using <code>np.vectorize()</code> and apply it to the <code>age</code> variable to create an <code>age_group</code> variable.</p>
<p>(If you prefer, you can also use <code>pd.cut()</code> to create the <code>age_group</code> variable.)</p>
<div id="b96ffb9d" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> assign_age_group(age): </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="dv">18</span> <span class="op">&lt;=</span> age <span class="op">&lt;=</span> <span class="dv">36</span>: </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"18-36"</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="dv">37</span> <span class="op">&lt;=</span> age <span class="op">&lt;=</span> <span class="dv">47</span>:</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"37-47"</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="dv">48</span> <span class="op">&lt;=</span> age <span class="op">&lt;=</span> <span class="dv">57</span>:</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"48-58"</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>: </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"58+"</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>age_group_vec <span class="op">=</span> np.vectorize(assign_age_group)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>tb[<span class="st">"age_group"</span>] <span class="op">=</span> age_group_vec(tb[<span class="st">"age"</span>])</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>tb</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">employment</th>
<th data-quarto-table-cell-role="th">alcohol</th>
<th data-quarto-table-cell-role="th">smoking</th>
<th data-quarto-table-cell-role="th">wtinkgs</th>
<th data-quarto-table-cell-role="th">htincms</th>
<th data-quarto-table-cell-role="th">bmi</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">first_visit_location</th>
<th data-quarto-table-cell-role="th">first_visit_cost</th>
<th data-quarto-table-cell-role="th">second_visit_location</th>
<th data-quarto-table-cell-role="th">second_visit_cost</th>
<th data-quarto-table-cell-role="th">third_visit_location</th>
<th data-quarto-table-cell-role="th">third_visit_cost</th>
<th data-quarto-table-cell-role="th">health_sys_delay_(in_days)</th>
<th data-quarto-table-cell-role="th">treatment_initiation_delay_(in_days)</th>
<th data-quarto-table-cell-role="th">total_cost</th>
<th data-quarto-table-cell-role="th">age_group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>100202</td>
<td>Male</td>
<td>57</td>
<td>Middle</td>
<td>Working</td>
<td>Yes</td>
<td>Yes</td>
<td>58.0</td>
<td>165.0</td>
<td>21.3</td>
<td>...</td>
<td>GH</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>15.0</td>
<td>10.0</td>
<td>0</td>
<td>48-58</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>100396</td>
<td>Female</td>
<td>66</td>
<td>No Education</td>
<td>Non - Working</td>
<td>No</td>
<td>No</td>
<td>32.0</td>
<td>163.0</td>
<td>12.0</td>
<td>...</td>
<td>Pvt. docto</td>
<td>1500</td>
<td>Pvt. clini</td>
<td>1000</td>
<td>Pvt. hospi</td>
<td>2500</td>
<td>60.0</td>
<td>4.0</td>
<td>5000</td>
<td>58+</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>100590</td>
<td>Female</td>
<td>45</td>
<td>Missing</td>
<td>Non - Working</td>
<td>No</td>
<td>No</td>
<td>46.0</td>
<td>150.0</td>
<td>20.4</td>
<td>...</td>
<td>Pvt. docto</td>
<td>2000</td>
<td>Pvt. docto</td>
<td>3000</td>
<td>PHC</td>
<td>0</td>
<td>43.0</td>
<td>21.0</td>
<td>5000</td>
<td>37-47</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>100687</td>
<td>Male</td>
<td>27</td>
<td>Middle</td>
<td>Non - Working</td>
<td>No</td>
<td>No</td>
<td>51.0</td>
<td>165.0</td>
<td>18.7</td>
<td>...</td>
<td>Pvt. hospi</td>
<td>20000</td>
<td>Pvt. hospi</td>
<td>1500</td>
<td>PHC</td>
<td>0</td>
<td>35.0</td>
<td>5.0</td>
<td>21500</td>
<td>18-36</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>100784</td>
<td>Male</td>
<td>54</td>
<td>Middle</td>
<td>Non - Working</td>
<td>No</td>
<td>No</td>
<td>39.0</td>
<td>160.0</td>
<td>15.2</td>
<td>...</td>
<td>Pvt. docto</td>
<td>1000</td>
<td>GH</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>14.0</td>
<td>6.0</td>
<td>1000</td>
<td>48-58</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">875</th>
<td>1604672</td>
<td>Male</td>
<td>44</td>
<td>Middle</td>
<td>Working</td>
<td>Yes</td>
<td>Yes</td>
<td>42.7</td>
<td>175.0</td>
<td>13.9</td>
<td>...</td>
<td>Pvt. docto</td>
<td>9000</td>
<td>Pvt. docto</td>
<td>800</td>
<td>GH</td>
<td>0</td>
<td>14.0</td>
<td>11.0</td>
<td>9800</td>
<td>37-47</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">876</th>
<td>1604769</td>
<td>Male</td>
<td>60</td>
<td>Middle</td>
<td>Working</td>
<td>No</td>
<td>No</td>
<td>64.2</td>
<td>175.0</td>
<td>21.0</td>
<td>...</td>
<td>Pvt. clini</td>
<td>500</td>
<td>Tambram Sanatorium</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>14.0</td>
<td>10.0</td>
<td>500</td>
<td>58+</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">877</th>
<td>1604866</td>
<td>Male</td>
<td>63</td>
<td>Middle</td>
<td>Working</td>
<td>No</td>
<td>Yes</td>
<td>38.5</td>
<td>160.0</td>
<td>15.0</td>
<td>...</td>
<td>Pvt. docto</td>
<td>1000</td>
<td>Tambram Sanatorium</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>180.0</td>
<td>22.0</td>
<td>1000</td>
<td>58+</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">878</th>
<td>1604963</td>
<td>Male</td>
<td>65</td>
<td>No Education</td>
<td>Working</td>
<td>No</td>
<td>No</td>
<td>37.0</td>
<td>167.0</td>
<td>13.3</td>
<td>...</td>
<td>PHC</td>
<td>0</td>
<td>Tambram Sanatorium</td>
<td>0</td>
<td>NaN</td>
<td>0</td>
<td>150.0</td>
<td>20.0</td>
<td>0</td>
<td>58+</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">879</th>
<td>1605060</td>
<td>Male</td>
<td>60</td>
<td>Middle</td>
<td>Working</td>
<td>No</td>
<td>No</td>
<td>46.8</td>
<td>155.5</td>
<td>19.4</td>
<td>...</td>
<td>Pvt. hospi</td>
<td>300</td>
<td>Pvt. clini</td>
<td>3200</td>
<td>GH</td>
<td>0</td>
<td>90.0</td>
<td>2.0</td>
<td>3500</td>
<td>58+</td>
</tr>
</tbody>
</table>

<p>880 rows × 23 columns</p>
</div>
</div>
</div>
<p>Now, check if we met our goal of having a similar number of patients in each age group using the <code>value_counts()</code> method:</p>
<div id="b3569f04" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabulate age groups</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>tb[<span class="st">"age_group"</span>].value_counts(normalize<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>age_group
58+      0.264773
18-36    0.248864
48-58    0.243182
37-47    0.243182
Name: proportion, dtype: float64</code></pre>
</div>
</div>
<p><strong>Checkpoint:</strong> If you classified the age groups correctly, you will see that each age group has approximately 24-26% of the patients.</p>
</section>
<section id="table-of-costs-by-age-group" class="level2">
<h2 class="anchored" data-anchor-id="table-of-costs-by-age-group">3.2. Table of Costs by Age Group</h2>
<p>Next, summarize the total healthcare costs by age group. Use pandas methods to group by <code>age_group</code> and create a summary table with two variables:</p>
<ul>
<li>The number of patients in each age group</li>
<li>The mean total cost for each age group</li>
</ul>
<p>Store the resulting DataFrame as an object called <code>age_cost_table</code>.</p>
<div id="4e8a978a" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary table for age groups</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>age_cost_table <span class="op">=</span> (</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    tb.groupby(<span class="st">"age_group"</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    .agg(num_inds<span class="op">=</span>(<span class="st">"id"</span>, <span class="st">"size"</span>), mean_cost<span class="op">=</span>(<span class="st">"total_cost"</span>, <span class="st">"mean"</span>))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    .reset_index()</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>age_cost_table</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">age_group</th>
<th data-quarto-table-cell-role="th">num_inds</th>
<th data-quarto-table-cell-role="th">mean_cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>18-36</td>
<td>219</td>
<td>2141.643836</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>37-47</td>
<td>214</td>
<td>1799.953271</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>48-58</td>
<td>214</td>
<td>1219.158879</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>58+</td>
<td>233</td>
<td>1886.309013</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="visualize-costs-by-age-group" class="level2">
<h2 class="anchored" data-anchor-id="visualize-costs-by-age-group">3.3. Visualize Costs by Age Group</h2>
<p>Using <code>plotly.express</code> and the costs summary table you created earlier, create a bar plot of mean costs by age group.</p>
<div id="cd21c82f" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>px.bar(age_cost_table, x<span class="op">=</span><span class="st">"age_group"</span>, y<span class="op">=</span><span class="st">"mean_cost"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.1.1.min.js" integrity="sha256-HUEFyfiTnZJxCxur99FjbKYTvKSzwDaD3/x5TqHpFu4=" crossorigin="anonymous"></script>                <div id="9bb99da2-434a-4be7-b487-1848831a5ef2" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("9bb99da2-434a-4be7-b487-1848831a5ef2")) {                    Plotly.newPlot(                        "9bb99da2-434a-4be7-b487-1848831a5ef2",                        [{"hovertemplate":"age_group=%{x}\u003cbr\u003emean_cost=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"","orientation":"v","showlegend":false,"textposition":"auto","x":["18-36","37-47","48-58","58+"],"xaxis":"x","y":{"dtype":"f8","bdata":"NWnSpEm7oECUxkcm0B+cQG72C7GiDJNA4wnfbTx5nUA="},"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermap":[{"type":"scattermap","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"age_group"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"mean_cost"}},"legend":{"tracegroupgap":0},"barmode":"relative"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('9bb99da2-434a-4be7-b487-1848831a5ef2');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };            </script>        </div>
</div>
</div>
<p>Write a short interpretation of the plot.</p>
</section>
</section>
<section id="bonus-challenge-optional" class="level1">
<h1>4. Bonus Challenge (Optional)</h1>
<p>If you finish early and have extra time, you can explore and transform the dataset further.</p>
<p>We can look at two types of health facilities in the dataset: private and public (government).</p>
<div id="b0f884e1" class="cell" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List of healthcare locations</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>tb[<span class="st">"first_visit_location"</span>].unique()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>array(['GH', 'Pvt. docto', 'Pvt. hospi', 'T.Govt', 'PHC', 'Pvt. clini',
       'Tambram sanatorium', 'T.Pvt', 'Other'], dtype=object)</code></pre>
</div>
</div>
<p>Note: PHC = primary health center, GH = govt hospital, etc.</p>
<section id="comparing-delays-in-public-vs-private-health-facilities" class="level2">
<h2 class="anchored" data-anchor-id="comparing-delays-in-public-vs-private-health-facilities">4.1. Comparing Delays in Public vs Private Health Facilities</h2>
<p>Let’s create a new variable indicating whether a healthcare location is private or public. We can do this using the <code>str.contains()</code> function from pandas.</p>
<div id="d9fe76b3" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tb[<span class="st">'first_visit_type'</span>] <span class="op">=</span> np.where(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    tb[<span class="st">'first_visit_location'</span>].<span class="bu">str</span>.contains(<span class="st">'Pvt'</span>),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Private'</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Public'</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Inspect the new variable in <code>tb</code>.</p>
<p>Your assignment for this challenge is to summarize delays in treatment and compare the length of delays between private and public health facilities.</p>
<p>You can start by making a summary table of <code>treatment_initiation_delay_in_days</code>, grouped by <code>first_visit_type</code>. Then visualize the data and draw insights from your findings.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>